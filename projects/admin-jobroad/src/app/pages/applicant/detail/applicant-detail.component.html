<div class="grid">
    <div class="col-12 mt-3">
        <p-card>
            <p-steps [model]="status" [readonly]="false" [activeIndex]="activeIndex"
                (activeIndexChange)="onActiveIndexChange($event)"></p-steps>
        </p-card>
    </div>
    <div class="col-12 md:col-5 buttons">
        <app-button type="button" label="Back" class="mr-2" classBtn="p-button-secondary"
            link="/jobs/detail/{{jobId}}"></app-button>
        <app-button *ngIf="isApplied" type="button" label="Assesment" (click)="assesmentClick()" class="mr-2"
            classBtn="p-button-primary"></app-button>

        <app-button *ngIf="isAssesment" type="button" label="Update Notes" (click)="assesmentNoteClick()" class="mr-2"
            classBtn="p-button-secondary mt-2"></app-button>
        <app-button *ngIf="isAssesment" type="button" label="Interview" (click)="interviewClick()" class="mr-2"
            classBtn="p-button-primary mt-2"></app-button>


        <app-button *ngIf="isInterview" type="button" label="Update Notes" (click)="interviewNoteClick()" class="mr-2"
            classBtn="p-button-secondary mt-2"></app-button>
        <app-button *ngIf="isInterview" type="button" label="Medical CheckUp" (click)="mcuClick()" class="mr-2"
            classBtn="p-button-primary mt-2"></app-button>

        <app-button *ngIf="isMcu" type="button" label="Offering Letter" (click)="offeringClick()" class="mr-2"
            classBtn="p-button-primary mt-2"></app-button>

    </div>
    <div class="col-12 md:col-1 md:col-offset-6 buttons">
        <app-button type="button" (click)="reject()" label="Reject" class="mr-2"
            classBtn="p-button-danger"></app-button>
    </div>
    <candidate-detail *ngIf="isApplied"></candidate-detail>
    <div class="col-12 " *ngIf="isApplied">

        <!-- Modal Form Insert Assesment -->
        <p-dialog header="Assesment Form" [responsive]="true" [modal]="true" [(visible)]="assesmentForm">
            <pre>
                {{assesmentReqDto.value | json}}
            </pre>
            <form [formGroup]="assesmentReqDto" (ngSubmit)="submitAssesment()">
                <div class="p-fluid p-formgrid grid assesment align-items-center">
                    <div class="col-12 md:col-4">
                        <label for="location">Location <span class="text-red-500">*</span></label>
                    </div>
                    <div class="col-12 md:col-8">
                        <input pInputText id="location" formControlName="assesmentLocation" type="text" required />
                    </div>
                    <div class="col-12 md:col-4">
                        <label for="date">Date <span class="text-red-500">*</span></label>
                    </div>
                    <div class="col-12 md:col-8">
                        <input pInputText id="date" required type="datetime-local" formControlName="assesmentDate" />
                    </div>
                    <app-button backgroundColor="var(--PRIMARY)" [loading]="loading" typeBtn="submit" label="Add"
                        iconBtn="pi pi-plus" class=" mr-2"></app-button>
                </div>
            </form>
            <!-- </p-card> -->
        </p-dialog>
    </div>
    <div class="assesment col-12 justify-content-center" *ngIf="isAssesment">
        <p-card header="Assesment">
            <div class="grid">
                <div class="col-12 md:col-5"><i class="pi pi-calendar"></i> Date</div>
                <div class="col-12 md:col-1">:</div>
                <div class="col-12 md:col-6">{{assesmentData?.assesmentDate}}</div>

                <div class="col-12 md:col-5"><i class="pi pi-home"></i> Location</div>
                <div class="col-12 md:col-1">:</div>
                <div class="col-12 md:col-6">{{assesmentData?.assesmentLocation}}</div>

                <div class="col-12 md:col-5"><i class="pi pi-book"></i> Notes</div>
                <div class="col-12 md:col-1">:</div>
                <div class="col-12 md:col-6">{{assesmentData?.notes}}</div>
                <div class="col-12 md:col-12">
                    <h4>Contact Person</h4>
                    <hr>
                </div>
                <div class="col-12 md:col-5">Name</div>
                <div class="col-12 md:col-1">:</div>
                <div class="col-12 md:col-6">{{pic?.fullName}}</div>
                <div class="col-12 md:col-5">Email</div>
                <div class="col-12 md:col-1">:</div>
                <div class="col-12 md:col-6">{{pic?.email}}</div>
            </div>
        </p-card>

        <!-- Modal Update Assesment Notes -->
        <p-dialog header="Update Assesment Notes" [breakpoints]="{ '960px': '75vw' }" [style]="{ width: '50vw' }"
            [modal]="true" [(visible)]="assesmentNoteForm">
            <form [formGroup]="assesmentNotesReqDto" (ngSubmit)="assesmentNotesUpdate()">
                <div class="grid">
                    <div class="col-12">
                        <label for="notes">Notes <span class="text-red-500">*</span></label>
                    </div>
                    <div class="col-12">
                        <textarea pInputTextarea id="notes" class="col-12" rows="10" formControlName="notes"></textarea>
                    </div>
                </div>
                <app-button backgroundColor="var(--PRIMARY)" [loading]="loading" typeBtn="submit" label="Add"
                    iconBtn="pi pi-plus" class=" mr-2"></app-button>
            </form>
        </p-dialog>
    </div>
    <div class="col-10 " *ngIf="isAssesment">

        <!-- Modal Form Insert Interview -->
        <p-dialog header="Interview Form" [breakpoints]="{ '960px': '75vw' }" [style]="{ width: '50vw' }" [modal]="true"
            [(visible)]="interviewForm">
            <form [formGroup]="interviewReqDto" (ngSubmit)="interviewSubmit()">
                <div class="p-formgrid grid assesment align-items-center">
                    <div class="col-12 md:col-4">
                        <label for="location">Location <span class="text-red-500">*</span></label>
                    </div>
                    <div class="col-12 md:col-8">
                        <input pInputText id="location" formControlName="interviewLocation" type="text" required />
                    </div>
                    <div class="col-12 md:col-4">
                        <label for="date">Date <span class="text-red-500">*</span></label>
                    </div>
                    <div class="col-12 md:col-8">
                        <input pInputText id="date" required type="datetime-local" formControlName="interviewDate" />
                    </div>
                    <app-button backgroundColor="var(--PRIMARY)" [loading]="loading" typeBtn="submit" label="Add"
                        iconBtn="pi pi-plus" class=" mr-2"></app-button>
                </div>
            </form>
        </p-dialog>
    </div>
    <div class="interview col-12" *ngIf="isInterview">
        <p-card header="Interview Data ">

            <div class="grid">
                <div class="col-12 md:col-5"><i class="pi pi-calendar"></i> Date</div>
                <div class="col-12 md:col-1">:</div>
                <div class="col-12 md:col-6">{{interviewData?.interviewDate}}</div>

                <div class="col-12 md:col-5"><i class="pi pi-home"></i> Location</div>
                <div class="col-12 md:col-1">:</div>
                <div class="col-12 md:col-6">{{interviewData?.interviewLocation}}</div>

                <div class="col-12 md:col-5"><i class="pi pi-book"></i> Notes</div>
                <div class="col-12 md:col-1">:</div>
                <div class="col-12 md:col-6">{{reviewData?.notes}}</div>

                <div class="col-12 md:col-5"><i class="pi pi-info-circle"></i> Score</div>
                <div class="col-12 md:col-1">:</div>
                <div class="col-12 md:col-6">{{reviewData?.score}}</div>
                <div class="col-12 md:col-12">
                    <h4>Contact Person</h4>
                    <hr>
                </div>
                <div class="col-12 md:col-5">Name</div>
                <div class="col-12 md:col-1">:</div>
                <div class="col-12 md:col-6">{{pic?.fullName}}</div>
                <div class="col-12 md:col-5">Email</div>
                <div class="col-12 md:col-1">:</div>
                <div class="col-12 md:col-6">{{pic?.email}}</div>
            </div>
        </p-card>

        <!-- Modal Update Interview Notes -->
        <p-dialog header="Update Interview Notes" [breakpoints]="{ '960px': '75vw' }" [style]="{ width: '50vw' }"
            [(visible)]="interviewNoteForm" [modal]="true">
            <form [formGroup]="reviewReqDto" (ngSubmit)="interviewNotesUpdate()">
                <div class="grid">
                    <div class="col-12">
                        <label for="notes">Notes <span class="text-red-500">*</span></label>
                    </div>
                    <div class="col-12">
                        <textarea pInputTextarea id="notes" class="col-12" rows="10" formControlName="notes"></textarea>
                    </div>
                </div>
                <app-button backgroundColor="var(--PRIMARY)" [loading]="loading" typeBtn="submit" label="Add"
                    iconBtn="pi pi-plus" class=" mr-2"></app-button>
            </form>
        </p-dialog>

        <!-- Modal Form Insert MCU  -->
        <p-dialog header="Upload Medical Check Up File" [responsive]="true" [breakpoints]="{ '960px': '75vw' }"
            [style]="{ width: '50vw' }" [modal]="true" [(visible)]="mcuForm">
            <form [formGroup]="mcuReqDto" (ngSubmit)="submitMcu()">
                <p-fileUpload mode="advanced" chooseLabel="Upload" styleClass="bg-green-700" chooseIcon="pi pi-upload"
                    class="form-control mb-2" [multiple]="true" [showUploadButton]="false" type="file" id="picture"
                    (onSelect)="fileUpload($event)" required></p-fileUpload>
                <app-button backgroundColor="var(--PRIMARY)" [loading]="loading" typeBtn="submit" label="Add"
                    iconBtn="pi pi-plus" class="mt-2"></app-button>
            </form>
        </p-dialog>
    </div>

    <div class="mcu col-12" *ngIf="isMcu">
        <p-card header="Medical Check Up Data">
            <p-table [value]="mcuDatas">
                <ng-template pTemplate="header">
                    <tr>
                        <th>
                            No
                        </th>
                        <th>
                            FileName
                        </th>
                        <th>
                            File Extension
                        </th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-m let-i="rowIndex">
                    <tr>
                        <td>{{i+1}}</td>
                        <td><a [href]="m.id | url">file-{{i+1}}</a></td>
                        <td>{{m.fileExtension}}</td>
                    </tr>
                </ng-template>
            </p-table>
        </p-card>

        <p-dialog header="Form Offering Letter" [breakpoints]="{ '960px': '75vw' }" [style]="{ width: '50vw' }"
            [modal]="true" [(visible)]="offeringForm" [modal]="true">
            <form [formGroup]="offeringReqDto" (ngSubmit)="offeringSubmit()">
                <div class="grid">
                    <div class="col-12 md:col-4">
                        <label for="address">Address</label>
                    </div>
                    <div class="col-12 md:col-8">
                        <textarea pInputTextarea id="address" formControlName="address" class="col-12"
                            rows="10"></textarea>
                    </div>
                    <div class="col-12 md:col-4">
                        <label htmlFor="salary">Salary</label>
                    </div>
                    <div class="col-12 md:col-8">
                        <p-inputNumber id="salary" inputId="max" mode="currency" currency="IDR" locale="jp-JP"
                            formControlName="salary"></p-inputNumber>
                    </div>
                    <app-button backgroundColor="var(--PRIMARY)" [loading]="loading" typeBtn="submit" label="Add"
                        iconBtn="pi pi-plus" class="mt-2"></app-button>
                </div>
            </form>
        </p-dialog>
    </div>

    <div class="offering-letter " *ngIf="isOffering">

        <app-button backgroundColor="var(--PRIMARY)" [loading]="loading" typeBtn="submit" label="Accept"
            iconBtn="pi pi-user-plus" class="mt-2" (click)="accept()"></app-button>
        <h3>Waiting for candidate to accept the offer ....</h3>

        <p-dialog [breakpoints]="{ '960px': '75vw' }" [style]="{ width: '50vw' }" [modal]="true"
            [(visible)]="hiringForm" header="Hiring Form">
            <form [formGroup]="hiringReqDto" (ngSubmit)="hiringSubmit()">
                <div class="grid mt-3">
                    <div class="start-date">
                        <div class="col-12 md:col-4">
                            <label for="start-date">Start Date</label>
                        </div>
                        <div class="col-12 md:col-8">
                            <input pInputText id="start-date" required type="date"
                                formControlName="startDate" />
                        </div>
                    </div>
                    <div class="end-date" *ngIf="job?.jobName == intern || job?.jobName == contract">
                        <div class="col-12 md:col-4">
                            <label for="end-date">Start Date</label>
                        </div>
                        <div class="col-12 md:col-8">
                            <input pInputText id="end-date" type="date" formControlName="endDate" />
                        </div>
                    </div>
                </div>
                <app-button backgroundColor="var(--PRIMARY)" [loading]="loading" typeBtn="submit" label="Add"
                    iconBtn="pi pi-plus" class="mt-2"></app-button>
            </form>
        </p-dialog>

    </div>
</div>
